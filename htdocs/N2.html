<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device=width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <link rel="stylesheet" href="/css/style.css">
  <title>N2</title>
</head>
<body>

  <button onclick="window.location.href = 'index.html';">Главная</button>

  <div class="container">
	  <h3>CSV-file</h3>
  </div>

  <form action="upload.php" method="post" enctype="multipart/form-data">
    <p>CSV: <input type="file" name="file"/></p>
    <input type="submit"/>

  <div id="main">
    <h4>
      Файл N2.php содержит форму отправки файлов, файл upload.php — обработчик.
    </h4>
    <p>
      Дыры в безопасности и методы решения:
    </p>
    <p>
      Прежде всего, поймите, что загрузка файла означает,
      что пользователь предоставляет вам большое количество
      данных в различных форматах, и что пользователь имеет
      полный контроль над этими данными. Это касается даже
      текстового поля обычной формы, загрузка файлов -
      это то же самое и даже больше. Первое правило гласит:
      Не доверяйте ничему из этого.
    </p>
    <p>
      Что вы получаете от пользователя при загрузке файла:
    </p>
    <ul>
      <li>данные файла</li>
      <li>имя файла</li>
      <li>MIME-тип</li>
    </ul>
    <p>
      Нельзя доверять MIME-типу в $_FILES['file']['type']. Это совершенно произвольное значение, вводимое пользователем.
    </p>
    <p>
      Не используйте имя файла для чего-то важного.
      Это совершенно произвольное значение, вводимое пользователем.
      Вы не можете доверять расширению файла или имени в целом.
      Не сохраняйте файл на жестком диске сервера, используя что-то
      вроде 'dir/' . $_FILES['file']['name']. Если имя будет '../../../passwd',
      вы перезапишете файлы в других каталогах. Всегда генерируйте случайное
      имя для сохранения файла. При желании вы можете сохранить оригинальное
      имя файла в базе данных в качестве метаданных.
    </p>
    <p>
      Никогда не позволяйте никому и ничему получать произвольный доступ к файлу.
      Например, если злоумышленник загрузит на ваш сервер файл malicious.php,
      а вы сохраните его в каталоге webroot вашего сайта, пользователь может
      просто перейти по адресу example.com/uploads/malicious.php, выполнить
      этот файл и запустить произвольный PHP-код на вашем сервере.
    </p>
    <p>
      Никогда не храните произвольные загруженные файлы в открытом доступе,
      всегда храните их там, где доступ к ним имеет только ваше приложение.
    </p>
    <p>
      Разрешайте доступ к файлам только определенным процессам.
      Если это должен быть файл изображения, разрешите прямой доступ к файлу
      только скрипту, который читает изображения и изменяет их размер.
      Если у этого скрипта возникают проблемы с чтением файла, то это,
      скорее всего, не файл изображения, отметьте его и/или отбросьте.
      То же самое относится и к другим типам файлов. Если предполагается,
      что файл может быть загружен другими пользователями, создайте скрипт,
      который предоставляет файл для загрузки и больше ничего с ним не делает.
    </p>
    <p>
      Если вы не знаете, с каким типом файла имеете дело, определите MIME-тип
      файла самостоятельно и/или попробуйте позволить определенному процессу
      открыть файл (например, пусть процесс изменения размера изображения
      попробует изменить размер предполагаемого изображения).
      Будьте осторожны и здесь, если в этом процессе есть уязвимость,
      то злонамеренно созданный файл может использовать ее, что может привести
      к нарушению безопасности (наиболее распространенным примером
      таких атак является Adobe PDF Reader)
    </p>
  </div>

</body>
</html>
